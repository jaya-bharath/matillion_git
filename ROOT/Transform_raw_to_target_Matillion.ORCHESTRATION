{"job":{"components":{"2966":{"id":2966,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-768,"y":-16,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2975],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2967":{"id":2967,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-608,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2975],"outputSuccessConnectorIDs":[2972],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_INCREMENTAL_VALUE"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"/* Note: this query will be run as a subquery for the purposes of sampling the data.\n   As such it will be restricted by any subquery limitations specified by the current platform. */\n   \n   SELECT COALESCE(A.INCREMENTAL_COLUMN,B.INCREMENTAL_COLUMN) AS INCREMENTAL_COLUMN,\n\tCOALESCE(A.INCREMENTAL_VALUE,B.INCREMENTAL_VALUE) AS INCREMENTAL_VALUE FROM \n   (SELECT * FROM ${DB}.${SCHEMA}.CONTROL_FCR_APP WHERE JOB_NAME= '${JOB_NAME}') A\n   RIGHT JOIN\n   (SELECT '${JOB_NAME}' AS JOB_NAME,'${INCREMENTAL_COLUMN}' AS INCREMENTAL_COLUMN, '${INCREMENTAL_VALUE}' AS INCREMENTAL_VALUE) B\n   ON B.JOB_NAME = A.JOB_NAME"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INCREMENTAL_COLUMN"},"2":{"slot":2,"type":"STRING","value":"INCREMENTAL_COLUMN"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"INCREMENTAL_VALUE"},"2":{"slot":2,"type":"STRING","value":"INCREMENTAL_VALUE"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"FCR_DEV"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CONTROL_FCR_APP"}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INCREMENTAL_COLUMN"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"INCREMENTAL_VALUE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_NAME"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"IS_INCREMENTAL"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"LAST_UPDATED"}}}},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PUBLIC"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JOB_NAME"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"AZURE_TO_SNOWFLAKE"}}}},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2968":{"id":2968,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-448,"y":-16,"width":32,"height":32,"inputConnectorIDs":[2972],"outputSuccessConnectorIDs":[2973],"outputFailureConnectorIDs":[2976],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRANSFORMATION_INTO_TRIPS"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT INTO ${DB}.${TARGET_SCHEMA}.${TARGET_TABLE} select\nTRIPDURATION,\nSTARTTIME,\nSTOPTIME,\nSTART_STATION_ID,\nSTART_STATION_NAME,\nSTART_STATION_LATITUDE,\nSTART_STATION_LONGITUDE,\nEND_STATION_ID,\nEND_STATION_NAME,\nEND_STATION_LATITUDE,\nEND_STATION_LONGITUDE,\nBIKEID,\nMEMBERSHIP_TYPE,\nUSERTYPE,\nBIRTH_YEAR,\n(case when GENDER = '1' THEN 'M' when GENDER = '2' THEN 'F' ELSE NULL END) as GENDER,\nupdated_at\nFROM ${DB}.${SOURCE_SCHEMA}.${SOURCE_TABLE_1}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2969":{"id":2969,"inputCardinality":"ONE","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":515156205,"x":-245,"y":32,"width":32,"height":32,"inputConnectorIDs":[2976],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"End Failure 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2970":{"id":2970,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-256,"y":-64,"width":32,"height":32,"inputConnectorIDs":[2973],"outputSuccessConnectorIDs":[2974],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"LATEST_INCREMENTAL_VALUE"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"/* Note: this query will be run as a subquery for the purposes of sampling the data.\n   As such it will be restricted by any subquery limitations specified by the current platform. */\n   \n--   SELECT COALESCE(MAX(${INCREMENTAL_COLUMN}), '${INCREMENTAL_VALUE}') AS INCREMENTAL_VALUE \n   SELECT COALESCE(MAX(${INCREMENTAL_COLUMN}), '${INCREMENTAL_VALUE}' ) AS INCREMENTAL_VALUE \n   FROM ${DB}.${TARGET_SCHEMA}.${TARGET_TABLE} \n   WHERE ${INCREMENTAL_COLUMN} > '${INCREMENTAL_VALUE}'"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INCREMENTAL_VALUE"},"2":{"slot":2,"type":"STRING","value":"INCREMENTAL_VALUE"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2971":{"id":2971,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-96,"y":-64,"width":32,"height":32,"inputConnectorIDs":[2974],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE_CONTROL_TABLE"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"MERGE INTO ${DB}.${SCHEMA}.CONTROL_FCR_APP C USING (\n  SELECT '${JOB_NAME}' AS JOB_NAME,\n  '${IS_INCREMENTAL}' AS IS_INCREMENTAL,\n  '${INCREMENTAL_COLUMN}' AS INCREMENTAL_COLUMN,\n  TO_TIMESTAMP_NTZ('${INCREMENTAL_VALUE}') AS INCREMENTAL_VALUE,\n  CURRENT_TIMESTAMP() AS LAST_UPDATED) AS N ON N.JOB_NAME = C.JOB_NAME\nWHEN MATCHED THEN UPDATE SET C.INCREMENTAL_VALUE = N.INCREMENTAL_VALUE\nWHEN NOT MATCHED THEN INSERT (JOB_NAME,IS_INCREMENTAL,INCREMENTAL_COLUMN,INCREMENTAL_VALUE,LAST_UPDATED) \n\tVALUES (N.JOB_NAME,N.IS_INCREMENTAL,N.INCREMENTAL_COLUMN,N.INCREMENTAL_VALUE,N.LAST_UPDATED)\n  "}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2972":{"id":2972,"sourceID":2967,"targetID":2968},"2973":{"id":2973,"sourceID":2968,"targetID":2970},"2974":{"id":2974,"sourceID":2970,"targetID":2971}},"failureConnectors":{"2976":{"id":2976,"sourceID":2968,"targetID":2969}},"unconditionalConnectors":{"2975":{"id":2975,"sourceID":2966,"targetID":2967}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"INCREMENTAL_COLUMN":{"definition":{"name":"INCREMENTAL_COLUMN","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"UPDATED_AT"},"INCREMENTAL_VALUE":{"definition":{"name":"INCREMENTAL_VALUE","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"1900-01-01 00:00:00"},"IS_INCREMENTAL":{"definition":{"name":"IS_INCREMENTAL","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"Y"},"JOB_NAME":{"definition":{"name":"JOB_NAME","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"AZURE_TO_SNOWFLAKE"},"LAST_UPDATED":{"definition":{"name":"LAST_UPDATED","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"CURRENT_TIMESTAMP()"},"SOURCE_SCHEMA":{"definition":{"name":"SOURCE_SCHEMA","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"RAW"},"SOURCE_TABLE_1":{"definition":{"name":"SOURCE_TABLE_1","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"TRIPS"},"TARGET_SCHEMA":{"definition":{"name":"TARGET_SCHEMA","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"PUBLIC"},"TARGET_TABLE":{"definition":{"name":"TARGET_TABLE","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"TRIPS"}},"grids":{"control_table_cols":{"definition":{"name":"control_table_cols","scope":"BRANCH","definitions":[{"name":"name","type":"TEXT"},{"name":"type","type":"TEXT"},{"name":"default","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["JOB_NAME","STRING","SAMPLE"]},{"values":["IS_INCREMENTAL","STRING","SAMPLE"]},{"values":["INCREMENTAL_COLUMN","STRING","SAMPLE"]},{"values":["INCREMENTAL_VALUE","STRING","SAMPLE"]},{"values":["LAST_UPDATED","TIMESTAMP","NULL"]}]},"control_table_output":{"definition":{"name":"control_table_output","scope":"TASKBATCH","definitions":[{"name":"JOB_NAME","type":"TEXT"},{"name":"IS_INCREMENTAL","type":"TEXT"},{"name":"INCREMENTAL_COLUMN","type":"TEXT"},{"name":"INCREMENTAL_VALUE","type":"TEXT"},{"name":"UPDATED_AT","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["","","","",""]}]}}},"info":{"name":"Transform_raw_to_target_Matillion","description":"Transformation from raw data layer to target layer Using Matillion.","type":"ORCHESTRATION","tag":"efd0955c-5840-42b0-8c6b-6772a9a6e3e7"}}